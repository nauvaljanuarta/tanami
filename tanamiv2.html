<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Rekomendasi Tanaman</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .question-container {
            transition: all 0.3s ease;
        }
        .fade-out {
            opacity: 0;
            transform: translateY(-20px);
        }
        .fade-in {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body class="bg-gradient-to-b from-green-50 to-green-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-green-800 mb-2">Sistem Rekomendasi Tanaman</h1>
            <p class="text-green-700 max-w-2xl mx-auto">
                Metode Fuzzy Mamdani untuk Rekomendasi Jenis Tanaman
            </p>
        </header>

        <div id="quiz-container" class="max-w-3xl mx-auto">
            <!-- Pertanyaan akan ditampilkan di sini -->
            <div id="question-container" class="bg-white rounded-lg shadow-md p-6 mb-8 question-container">
                <div id="progress-bar" class="w-full bg-gray-200 rounded-full h-2.5 mb-6">
                    <div id="progress" class="bg-green-600 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
                <h2 id="question-title" class="text-xl font-semibold text-green-700 mb-4">Pertanyaan 1</h2>
                <p id="question-text" class="text-gray-700 mb-6">Bagaimana kondisi suhu udara di lokasi penanaman?</p>
                
                <div id="options-container" class="space-y-3">
                    <!-- Opsi jawaban akan ditampilkan di sini -->
                </div>
                
                <div class="flex justify-between mt-8">
                    <button id="prev-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed" disabled>Sebelumnya</button>
                    <button id="next-btn" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed" disabled>Selanjutnya</button>
                </div>
            </div>
        </div>

        <!-- Hasil rekomendasi (awalnya tersembunyi) -->
        <div id="result-container" class="max-w-4xl mx-auto hidden">
            <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                <h2 class="text-2xl font-bold text-green-800 mb-4">Hasil Rekomendasi Tanaman</h2>
                
                <div id="recommendation-summary" class="mb-6 p-4 bg-green-50 rounded-lg">
                    <p class="text-lg font-medium text-green-800">Berdasarkan kondisi lingkungan yang Anda masukkan:</p>
                    <h3 id="main-recommendation" class="text-2xl font-bold text-green-700 mt-2">-</h3>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
                    <div class="bg-gray-50 rounded-lg p-4 text-center">
                        <h3 class="font-medium text-gray-800">Sayur</h3>
                        <div class="mt-2 h-4 bg-gray-200 rounded-full overflow-hidden">
                            <div id="vegetableBar" class="h-full bg-green-500" style="width: 0%"></div>
                        </div>
                        <p id="vegetableValue" class="mt-1 text-sm font-medium text-green-600">0%</p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4 text-center">
                        <h3 class="font-medium text-gray-800">Buah</h3>
                        <div class="mt-2 h-4 bg-gray-200 rounded-full overflow-hidden">
                            <div id="fruitBar" class="h-full bg-green-500" style="width: 0%"></div>
                        </div>
                        <p id="fruitValue" class="mt-1 text-sm font-medium text-green-600">0%</p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4 text-center">
                        <h3 class="font-medium text-gray-800">Tanaman Hias</h3>
                        <div class="mt-2 h-4 bg-gray-200 rounded-full overflow-hidden">
                            <div id="ornamentalBar" class="h-full bg-green-500" style="width: 0%"></div>
                        </div>
                        <p id="ornamentalValue" class="mt-1 text-sm font-medium text-green-600">0%</p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4 text-center">
                        <h3 class="font-medium text-gray-800">Tanaman Obat</h3>
                        <div class="mt-2 h-4 bg-gray-200 rounded-full overflow-hidden">
                            <div id="medicinalBar" class="h-full bg-green-500" style="width: 0%"></div>
                        </div>
                        <p id="medicinalValue" class="mt-1 text-sm font-medium text-green-600">0%</p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4 text-center">
                        <h3 class="font-medium text-gray-800">Tanaman Rempah</h3>
                        <div class="mt-2 h-4 bg-gray-200 rounded-full overflow-hidden">
                            <div id="spiceBar" class="h-full bg-green-500" style="width: 0%"></div>
                        </div>
                        <p id="spiceValue" class="mt-1 text-sm font-medium text-green-600">0%</p>
                    </div>
                </div>
                
                <div id="plant-details" class="mb-6">
                    <h3 class="text-xl font-semibold text-green-700 mb-3">Contoh Tanaman yang Direkomendasikan</h3>
                    <div id="plant-examples" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- Contoh tanaman akan ditampilkan di sini -->
                    </div>
                </div>
                
                <div id="recommendation-explanation" class="p-4 bg-gray-50 rounded-lg">
                    <h3 class="font-semibold text-green-700 mb-2">Penjelasan Rekomendasi</h3>
                    <p id="explanation-text" class="text-gray-700">-</p>
                </div>
                
                <button id="restart-btn" class="mt-6 w-full px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700">
                    Mulai Lagi
                </button>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6 mt-6">
                <h3 class="text-xl font-semibold text-green-700 mb-3">Parameter Lingkungan</h3>
                <div id="user-answers-summary" class="text-gray-700">
                    <!-- Ringkasan jawaban pengguna akan ditampilkan di sini -->
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6 mt-6">
                <h3 class="text-xl font-semibold text-green-700 mb-3">Metode Fuzzy Mamdani</h3>
                <p class="text-gray-700 mb-4">
                    Sistem rekomendasi ini menggunakan metode Fuzzy Mamdani untuk menentukan jenis tanaman yang paling cocok berdasarkan parameter lingkungan yang dimasukkan.
                </p>
                <div class="space-y-4">
                    <div>
                        <h4 class="font-medium text-green-700">1. Fuzzifikasi</h4>
                        <p class="text-gray-700 text-sm">Mengubah nilai input crisp menjadi derajat keanggotaan dalam himpunan fuzzy.</p>
                    </div>
                    <div>
                        <h4 class="font-medium text-green-700">2. Aplikasi Fungsi Implikasi</h4>
                        <p class="text-gray-700 text-sm">Menerapkan aturan fuzzy IF-THEN untuk menentukan output berdasarkan input.</p>
                    </div>
                    <div>
                        <h4 class="font-medium text-green-700">3. Komposisi Aturan</h4>
                        <p class="text-gray-700 text-sm">Mengkombinasikan semua output fuzzy dari setiap aturan menjadi satu himpunan fuzzy.</p>
                    </div>
                    <div>
                        <h4 class="font-medium text-green-700">4. Defuzzifikasi</h4>
                        <p class="text-gray-700 text-sm">Mengubah output fuzzy menjadi nilai crisp menggunakan metode Centroid.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="mt-10 py-6 bg-green-800 text-white text-center">
        <p>Sistem Rekomendasi Tanaman dengan Metode Fuzzy Mamdani &copy; 2025</p>
    </footer>

    <script>
        // Daftar pertanyaan
        const questions = [
            {
                id: 'temperature',
                title: 'Pertanyaan 1',
                text: 'Bagaimana kondisi suhu udara di lokasi penanaman?',
                options: [
                    { id: 'low', text: 'Rendah (< 20°C)', value: { lowTemp: 1.0, mediumTemp: 0.3, highTemp: 0.0 } },
                    { id: 'medium', text: 'Sedang (20-30°C)', value: { lowTemp: 0.3, mediumTemp: 1.0, highTemp: 0.3 } },
                    { id: 'high', text: 'Tinggi (> 30°C)', value: { lowTemp: 0.0, mediumTemp: 0.3, highTemp: 1.0 } }
                ]
            },
            {
                id: 'moisture',
                title: 'Pertanyaan 2',
                text: 'Bagaimana kondisi kelembapan tanah di lokasi penanaman?',
                options: [
                    { id: 'dry', text: 'Kering (< 30%)', value: { dryMoisture: 1.0, moistMoisture: 0.3, wetMoisture: 0.0 } },
                    { id: 'moist', text: 'Lembap (30-70%)', value: { dryMoisture: 0.3, moistMoisture: 1.0, wetMoisture: 0.3 } },
                    { id: 'wet', text: 'Basah (> 70%)', value: { dryMoisture: 0.0, moistMoisture: 0.3, wetMoisture: 1.0 } }
                ]
            },
            {
                id: 'ph',
                title: 'Pertanyaan 3',
                text: 'Bagaimana kondisi pH tanah di lokasi penanaman?',
                options: [
                    { id: 'acidic', text: 'Asam (pH < 6)', value: { acidicPh: 1.0, neutralPh: 0.3, basicPh: 0.0 } },
                    { id: 'neutral', text: 'Netral (pH 6-7)', value: { acidicPh: 0.3, neutralPh: 1.0, basicPh: 0.3 } },
                    { id: 'basic', text: 'Basa (pH > 7)', value: { acidicPh: 0.0, neutralPh: 0.3, basicPh: 1.0 } }
                ]
            },
            {
                id: 'light',
                title: 'Pertanyaan 4',
                text: 'Bagaimana intensitas cahaya di lokasi penanaman?',
                options: [
                    { id: 'low', text: 'Rendah (< 3000 lux)', value: { lowLight: 1.0, mediumLight: 0.3, highLight: 0.0 } },
                    { id: 'medium', text: 'Sedang (3000-7000 lux)', value: { lowLight: 0.3, mediumLight: 1.0, highLight: 0.3 } },
                    { id: 'high', text: 'Tinggi (> 7000 lux)', value: { lowLight: 0.0, mediumLight: 0.3, highLight: 1.0 } }
                ]
            }
        ];

        // Aturan fuzzy untuk rekomendasi tanaman (DIPERBAIKI)
        const rules = [
            // Aturan untuk Sayuran
            {
                condition: (values) => Math.min(
                    values.lowTemp || 0,
                    values.moistMoisture || 0,
                    values.neutralPh || 0,
                    values.mediumLight || 0
                ),
                output: 'vegetable',
                weight: 0.8,
                explanation: "Sayuran cocok untuk kondisi suhu rendah, kelembapan lembap, pH netral, dan cahaya sedang."
            },
            {
                condition: (values) => Math.min(
                    values.mediumTemp || 0,
                    values.moistMoisture || 0,
                    values.neutralPh || 0,
                    values.mediumLight || 0
                ),
                output: 'vegetable',
                weight: 0.9,
                explanation: "Sayuran sangat cocok untuk kondisi suhu sedang, kelembapan lembap, pH netral, dan cahaya sedang."
            },
            {
                condition: (values) => Math.min(
                    values.lowTemp || 0,
                    values.wetMoisture || 0,
                    values.neutralPh || 0,
                    values.mediumLight || 0
                ),
                output: 'vegetable',
                weight: 0.7,
                explanation: "Sayuran juga cocok untuk kondisi suhu rendah, kelembapan basah, pH netral, dan cahaya sedang."
            },
            // Aturan khusus untuk kombinasi suhu rendah, kelembapan kering, pH asam, cahaya rendah
            {
                condition: (values) => Math.min(
                    values.lowTemp || 0,
                    values.dryMoisture || 0,
                    values.acidicPh || 0,
                    values.lowLight || 0
                ),
                output: 'vegetable',
                weight: 0.3, // Bobot rendah karena kondisi kurang ideal
                explanation: "Beberapa sayuran masih bisa tumbuh dalam kondisi suhu rendah, kelembapan kering, pH asam, dan cahaya rendah, tetapi pertumbuhannya mungkin tidak optimal."
            },
            
            // Aturan untuk Buah
            {
                condition: (values) => Math.min(
                    values.highTemp || 0,
                    values.moistMoisture || 0,
                    values.neutralPh || 0,
                    values.highLight || 0
                ),
                output: 'fruit',
                weight: 0.9,
                explanation: "Tanaman buah cocok untuk kondisi suhu tinggi, kelembapan lembap, pH netral, dan cahaya tinggi."
            },
            {
                condition: (values) => Math.min(
                    values.mediumTemp || 0,
                    values.moistMoisture || 0,
                    values.neutralPh || 0,
                    values.highLight || 0
                ),
                output: 'fruit',
                weight: 0.8,
                explanation: "Tanaman buah juga cocok untuk kondisi suhu sedang, kelembapan lembap, pH netral, dan cahaya tinggi."
            },
            {
                condition: (values) => Math.min(
                    values.highTemp || 0,
                    values.wetMoisture || 0,
                    values.neutralPh || 0,
                    values.highLight || 0
                ),
                output: 'fruit',
                weight: 0.7,
                explanation: "Beberapa tanaman buah cocok untuk kondisi suhu tinggi, kelembapan basah, pH netral, dan cahaya tinggi."
            },
            // Aturan khusus untuk kombinasi suhu rendah, kelembapan kering, pH asam, cahaya rendah
            {
                condition: (values) => Math.min(
                    values.lowTemp || 0,
                    values.dryMoisture || 0,
                    values.acidicPh || 0,
                    values.lowLight || 0
                ),
                output: 'fruit',
                weight: 0.1, // Bobot sangat rendah karena kondisi tidak ideal
                explanation: "Kondisi suhu rendah, kelembapan kering, pH asam, dan cahaya rendah umumnya tidak ideal untuk tanaman buah."
            },
            
            // Aturan untuk Tanaman Hias
            {
                condition: (values) => Math.min(
                    values.mediumTemp || 0,
                    values.moistMoisture || 0,
                    values.neutralPh || 0,
                    values.lowLight || 0
                ),
                output: 'ornamental',
                weight: 0.9,
                explanation: "Tanaman hias cocok untuk kondisi suhu sedang, kelembapan lembap, pH netral, dan cahaya rendah."
            },
            {
                condition: (values) => Math.min(
                    values.lowTemp || 0,
                    values.moistMoisture || 0,
                    values.neutralPh || 0,
                    values.lowLight || 0
                ),
                output: 'ornamental',
                weight: 0.8,
                explanation: "Tanaman hias juga cocok untuk kondisi suhu rendah, kelembapan lembap, pH netral, dan cahaya rendah."
            },
            {
                condition: (values) => Math.min(
                    values.mediumTemp || 0,
                    values.wetMoisture || 0,
                    values.acidicPh || 0,
                    values.lowLight || 0
                ),
                output: 'ornamental',
                weight: 0.7,
                explanation: "Beberapa tanaman hias cocok untuk kondisi suhu sedang, kelembapan basah, pH asam, dan cahaya rendah."
            },
            // Aturan khusus untuk kombinasi suhu rendah, kelembapan kering, pH asam, cahaya rendah
            {
                condition: (values) => Math.min(
                    values.lowTemp || 0,
                    values.dryMoisture || 0,
                    values.acidicPh || 0,
                    values.lowLight || 0
                ),
                output: 'ornamental',
                weight: 0.6, // Bobot lebih tinggi karena beberapa tanaman hias tahan kondisi ini
                explanation: "Beberapa tanaman hias seperti kaktus dan sukulen dapat tumbuh dengan baik dalam kondisi suhu rendah, kelembapan kering, pH asam, dan cahaya rendah."
            },
            
            // Aturan untuk Tanaman Obat
            {
                condition: (values) => Math.min(
                    values.mediumTemp || 0,
                    values.dryMoisture || 0,
                    values.neutralPh || 0,
                    values.mediumLight || 0
                ),
                output: 'medicinal',
                weight: 0.9,
                explanation: "Tanaman obat cocok untuk kondisi suhu sedang, kelembapan kering, pH netral, dan cahaya sedang."
            },
            {
                condition: (values) => Math.min(
                    values.highTemp || 0,
                    values.dryMoisture || 0,
                    values.basicPh || 0,
                    values.highLight || 0
                ),
                output: 'medicinal',
                weight: 0.8,
                explanation: "Tanaman obat juga cocok untuk kondisi suhu tinggi, kelembapan kering, pH basa, dan cahaya tinggi."
            },
            {
                condition: (values) => Math.min(
                    values.lowTemp || 0,
                    values.moistMoisture || 0,
                    values.acidicPh || 0,
                    values.mediumLight || 0
                ),
                output: 'medicinal',
                weight: 0.7,
                explanation: "Beberapa tanaman obat cocok untuk kondisi suhu rendah, kelembapan lembap, pH asam, dan cahaya sedang."
            },
            // Aturan khusus untuk kombinasi suhu rendah, kelembapan kering, pH asam, cahaya rendah
            {
                condition: (values) => Math.min(
                    values.lowTemp || 0,
                    values.dryMoisture || 0,
                    values.acidicPh || 0,
                    values.lowLight || 0
                ),
                output: 'medicinal',
                weight: 0.4, // Bobot sedang karena beberapa tanaman obat tahan kondisi ini
                explanation: "Beberapa tanaman obat dapat tumbuh dalam kondisi suhu rendah, kelembapan kering, pH asam, dan cahaya rendah, meskipun tidak optimal."
            },
            
            // Aturan untuk Tanaman Rempah
            {
                condition: (values) => Math.min(
                    values.highTemp || 0,
                    values.dryMoisture || 0,
                    values.neutralPh || 0,
                    values.highLight || 0
                ),
                output: 'spice',
                weight: 0.9,
                explanation: "Tanaman rempah cocok untuk kondisi suhu tinggi, kelembapan kering, pH netral, dan cahaya tinggi."
            },
            {
                condition: (values) => Math.min(
                    values.mediumTemp || 0,
                    values.dryMoisture || 0,
                    values.neutralPh || 0,
                    values.mediumLight || 0
                ),
                output: 'spice',
                weight: 0.8,
                explanation: "Tanaman rempah juga cocok untuk kondisi suhu sedang, kelembapan kering, pH netral, dan cahaya sedang."
            },
            {
                condition: (values) => Math.min(
                    values.highTemp || 0,
                    values.moistMoisture || 0,
                    values.basicPh || 0,
                    values.highLight || 0
                ),
                output: 'spice',
                weight: 0.7,
                explanation: "Beberapa tanaman rempah cocok untuk kondisi suhu tinggi, kelembapan lembap, pH basa, dan cahaya tinggi."
            },
            // Aturan khusus untuk kombinasi suhu rendah, kelembapan kering, pH asam, cahaya rendah
            {
                condition: (values) => Math.min(
                    values.lowTemp || 0,
                    values.dryMoisture || 0,
                    values.acidicPh || 0,
                    values.lowLight || 0
                ),
                output: 'spice',
                weight: 0.2, // Bobot rendah karena kondisi kurang ideal
                explanation: "Kondisi suhu rendah, kelembapan kering, pH asam, dan cahaya rendah umumnya kurang ideal untuk tanaman rempah."
            }
        ];

        // Contoh tanaman untuk setiap kategori
        const plantExamples = {
            vegetable: [
                { name: 'Bayam', description: 'Mudah ditanam, kaya nutrisi, cocok di pot kecil', image: 'https://via.placeholder.com/150/4ade80/ffffff?text=Bayam' },
                { name: 'Selada', description: 'Tumbuh cepat, cocok untuk hidroponik', image: 'https://via.placeholder.com/150/4ade80/ffffff?text=Selada' },
                { name: 'Kangkung', description: 'Tahan berbagai kondisi, mudah perawatan', image: 'https://via.placeholder.com/150/4ade80/ffffff?text=Kangkung' }
            ],
            fruit: [
                { name: 'Stroberi', description: 'Bisa ditanam di pot, buah manis', image: 'https://via.placeholder.com/150/f87171/ffffff?text=Stroberi' },
                { name: 'Jeruk Nipis', description: 'Pohon kecil, cocok di halaman', image: 'https://via.placeholder.com/150/f87171/ffffff?text=Jeruk+Nipis' },
                { name: 'Pepaya', description: 'Tumbuh cepat, buah sepanjang tahun', image: 'https://via.placeholder.com/150/f87171/ffffff?text=Pepaya' }
            ],
            ornamental: [
                { name: 'Kaktus', description: 'Tahan kekeringan, minim perawatan', image: 'https://via.placeholder.com/150/a78bfa/ffffff?text=Kaktus' },
                { name: 'Lidah Mertua', description: 'Tahan kondisi kering, pembersih udara', image: 'https://via.placeholder.com/150/a78bfa/ffffff?text=Lidah+Mertua' },
                { name: 'Pakis', description: 'Cocok di tempat teduh dan lembap', image: 'https://via.placeholder.com/150/a78bfa/ffffff?text=Pakis' }
            ],
            medicinal: [
                { name: 'Lidah Buaya', description: 'Bermanfaat untuk kulit, mudah perawatan', image: 'https://via.placeholder.com/150/60a5fa/ffffff?text=Lidah+Buaya' },
                { name: 'Jahe', description: 'Rimpang berkhasiat, tumbuh di pot', image: 'https://via.placeholder.com/150/60a5fa/ffffff?text=Jahe' },
                { name: 'Kumis Kucing', description: 'Herba untuk ginjal, mudah perawatan', image: 'https://via.placeholder.com/150/60a5fa/ffffff?text=Kumis+Kucing' }
            ],
            spice: [
                { name: 'Serai', description: 'Aroma harum, pengusir nyamuk', image: 'https://via.placeholder.com/150/fbbf24/ffffff?text=Serai' },
                { name: 'Daun Salam', description: 'Pohon kecil, daun aromatik', image: 'https://via.placeholder.com/150/fbbf24/ffffff?text=Daun+Salam' },
                { name: 'Kemangi', description: 'Aroma khas, tumbuh cepat', image: 'https://via.placeholder.com/150/fbbf24/ffffff?text=Kemangi' }
            ]
        };

        // Deskripsi rekomendasi
        const recommendationDescriptions = {
            vegetable: "Tanaman sayur sangat cocok dengan kondisi lingkungan yang Anda masukkan. Sayuran umumnya membutuhkan sinar matahari yang cukup, kelembapan sedang, dan pH netral. Sayuran juga memberikan hasil yang dapat dikonsumsi dalam waktu relatif singkat.",
            fruit: "Tanaman buah adalah pilihan yang tepat untuk kondisi lingkungan yang Anda masukkan. Meskipun beberapa tanaman buah membutuhkan waktu lebih lama untuk berbuah, namun hasilnya akan sepadan. Pastikan untuk memberikan ruang yang cukup dan sinar matahari yang memadai.",
            ornamental: "Tanaman hias sangat sesuai dengan kondisi lingkungan yang Anda masukkan. Tanaman hias umumnya lebih fleksibel dalam hal pencahayaan dan dapat bertahan dengan perawatan minimal. Tanaman ini akan menambah keindahan dan kesegaran di lingkungan Anda.",
            medicinal: "Tanaman obat (TOGA) adalah rekomendasi terbaik untuk kondisi lingkungan yang Anda masukkan. Tanaman obat umumnya tidak memerlukan perawatan intensif dan dapat tumbuh di berbagai kondisi. Selain itu, tanaman ini memberikan manfaat kesehatan yang dapat digunakan sehari-hari.",
            spice: "Tanaman rempah sangat cocok dengan kondisi lingkungan yang Anda masukkan. Tanaman rempah umumnya tahan terhadap berbagai kondisi dan memberikan aroma serta rasa yang dapat dimanfaatkan untuk memasak. Banyak tanaman rempah juga memiliki manfaat kesehatan."
        };

        // Variabel untuk melacak pertanyaan saat ini dan jawaban
        let currentQuestionIndex = 0;
        const userAnswers = {};
        const userAnswersText = {};

        // Elemen DOM
        const questionContainer = document.getElementById('question-container');
        const questionTitle = document.getElementById('question-title');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const progressBar = document.getElementById('progress');
        const resultContainer = document.getElementById('result-container');
        const restartBtn = document.getElementById('restart-btn');

        // Fungsi untuk menampilkan pertanyaan
        function showQuestion(index) {
            const question = questions[index];
            
            // Update judul dan teks pertanyaan
            questionTitle.textContent = question.title;
            questionText.textContent = question.text;
            
            // Bersihkan opsi sebelumnya
            optionsContainer.innerHTML = '';
            
            // Tambahkan opsi baru
            question.options.forEach(option => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'flex items-center space-x-3';
                
                const input = document.createElement('input');
                input.type = 'radio';
                input.name = question.id;
                input.id = option.id;
                input.className = 'w-4 h-4 text-green-600 focus:ring-green-500';
                input.value = option.id;
                
                // Periksa apakah opsi ini sudah dipilih sebelumnya
                if (userAnswers[question.id] === option.id) {
                    input.checked = true;
                }
                
                // Tambahkan event listener
                input.addEventListener('change', () => {
                    userAnswers[question.id] = option.id;
                    userAnswers[question.id + '_value'] = option.value;
                    userAnswersText[question.id] = option.text;
                    nextBtn.disabled = false;
                });
                
                const label = document.createElement('label');
                label.htmlFor = option.id;
                label.className = 'text-gray-700 cursor-pointer';
                label.textContent = option.text;
                
                optionDiv.appendChild(input);
                optionDiv.appendChild(label);
                optionsContainer.appendChild(optionDiv);
            });
            
            // Update tombol navigasi
            prevBtn.disabled = index === 0;
            nextBtn.disabled = !userAnswers[question.id];
            
            // Jika ini pertanyaan terakhir, ubah teks tombol "Selanjutnya"
            if (index === questions.length - 1) {
                nextBtn.textContent = 'Lihat Hasil';
            } else {
                nextBtn.textContent = 'Selanjutnya';
            }
            
            // Update progress bar
            const progress = ((index + 1) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // Fungsi untuk pindah ke pertanyaan sebelumnya
        function goToPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                questionContainer.classList.add('fade-out');
                
                setTimeout(() => {
                    currentQuestionIndex--;
                    showQuestion(currentQuestionIndex);
                    questionContainer.classList.remove('fade-out');
                    questionContainer.classList.add('fade-in');
                    
                    setTimeout(() => {
                        questionContainer.classList.remove('fade-in');
                    }, 300);
                }, 300);
            }
        }

        // Fungsi untuk pindah ke pertanyaan berikutnya
        function goToNextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                questionContainer.classList.add('fade-out');
                
                setTimeout(() => {
                    currentQuestionIndex++;
                    showQuestion(currentQuestionIndex);
                    questionContainer.classList.remove('fade-out');
                    questionContainer.classList.add('fade-in');
                    
                    setTimeout(() => {
                        questionContainer.classList.remove('fade-in');
                    }, 300);
                }, 300);
            } else {
                // Ini adalah pertanyaan terakhir, tampilkan hasil
                showResults();
            }
        }

        // Fungsi untuk mengevaluasi aturan fuzzy (DIPERBAIKI)
        function evaluateRules() {
            // Gabungkan semua nilai dari jawaban pengguna
            const values = {};
            for (const key in userAnswers) {
                if (key.endsWith('_value')) {
                    const valueObj = userAnswers[key];
                    for (const valueKey in valueObj) {
                        values[valueKey] = valueObj[valueKey];
                    }
                }
            }
            
            // Evaluasi setiap aturan
            const results = {
                vegetable: 0,
                fruit: 0,
                ornamental: 0,
                medicinal: 0,
                spice: 0
            };
            
            let bestExplanation = {
                vegetable: "",
                fruit: "",
                ornamental: "",
                medicinal: "",
                spice: ""
            };
            
            // Evaluasi aturan umum
            rules.forEach(rule => {
                const ruleStrength = rule.condition(values) * rule.weight;
                
                if (ruleStrength > results[rule.output]) {
                    results[rule.output] = ruleStrength;
                    bestExplanation[rule.output] = rule.explanation;
                }
            });
            
            // Tambahkan penanganan khusus untuk kombinasi tertentu (DITAMBAHKAN)
            // Jika semua input adalah opsi pertama (suhu rendah, kelembapan kering, pH asam, cahaya rendah)
            if (
                userAnswers.temperature === 'low' && 
                userAnswers.moisture === 'dry' && 
                userAnswers.ph === 'acidic' && 
                userAnswers.light === 'low'
            ) {
                // Berikan bobot yang berbeda untuk setiap jenis tanaman
                results.vegetable = Math.max(results.vegetable, 0.3);
                results.fruit = Math.max(results.fruit, 0.1);
                results.ornamental = Math.max(results.ornamental, 0.6); // Tanaman hias mendapat bobot tertinggi
                results.medicinal = Math.max(results.medicinal, 0.4);
                results.spice = Math.max(results.spice, 0.2);
                
                // Perbarui penjelasan jika belum ada
                if (!bestExplanation.ornamental) {
                    bestExplanation.ornamental = "Untuk kondisi suhu rendah, kelembapan kering, pH asam, dan cahaya rendah, tanaman hias seperti kaktus dan sukulen adalah pilihan terbaik karena ketahanannya terhadap kondisi ekstrem.";
                }
            }
            
            return { results, bestExplanation };
        }

        // Fungsi untuk menormalisasi hasil
        function normalizeResults(results) {
            const total = Object.values(results).reduce((sum, val) => sum + val, 0);
            
            if (total === 0) return results; // Hindari pembagian dengan nol
            
            const normalized = {};
            for (const key in results) {
                normalized[key] = (results[key] / total) * 100;
            }
            
            return normalized;
        }

        // Fungsi untuk mendapatkan rekomendasi utama
        function getMainRecommendation(results) {
            let maxKey = Object.keys(results)[0];
            let maxValue = results[maxKey];
            
            for (const key in results) {
                if (results[key] > maxValue) {
                    maxValue = results[key];
                    maxKey = key;
                }
            }
            
            return {
                type: maxKey,
                value: maxValue
            };
        }

        // Fungsi untuk menampilkan hasil
        function showResults() {
            // Sembunyikan container pertanyaan
            document.getElementById('quiz-container').classList.add('hidden');
            
            // Evaluasi aturan fuzzy
            const { results, bestExplanation } = evaluateRules();
            const normalizedResults = normalizeResults(results);
            const mainRec = getMainRecommendation(normalizedResults);
            
            // Tampilkan hasil
            document.getElementById('vegetableBar').style.width = `${normalizedResults.vegetable}%`;
            document.getElementById('vegetableValue').textContent = `${normalizedResults.vegetable.toFixed(1)}%`;
            
            document.getElementById('fruitBar').style.width = `${normalizedResults.fruit}%`;
            document.getElementById('fruitValue').textContent = `${normalizedResults.fruit.toFixed(1)}%`;
            
            document.getElementById('ornamentalBar').style.width = `${normalizedResults.ornamental}%`;
            document.getElementById('ornamentalValue').textContent = `${normalizedResults.ornamental.toFixed(1)}%`;
            
            document.getElementById('medicinalBar').style.width = `${normalizedResults.medicinal}%`;
            document.getElementById('medicinalValue').textContent = `${normalizedResults.medicinal.toFixed(1)}%`;
            
            document.getElementById('spiceBar').style.width = `${normalizedResults.spice}%`;
            document.getElementById('spiceValue').textContent = `${normalizedResults.spice.toFixed(1)}%`;
            
            // Tampilkan rekomendasi utama
            let mainType;
            switch(mainRec.type) {
                case 'vegetable': mainType = 'Sayur'; break;
                case 'fruit': mainType = 'Buah'; break;
                case 'ornamental': mainType = 'Tanaman Hias'; break;
                case 'medicinal': mainType = 'Tanaman Obat (TOGA)'; break;
                case 'spice': mainType = 'Tanaman Rempah'; break;
                default: mainType = '-';
            }
            
            document.getElementById('main-recommendation').textContent = mainType;
            
            // Tampilkan penjelasan
            const explanation = bestExplanation[mainRec.type] + " " + recommendationDescriptions[mainRec.type];
            document.getElementById('explanation-text').textContent = explanation;
            
            // Tampilkan contoh tanaman
            const plantExamplesContainer = document.getElementById('plant-examples');
            plantExamplesContainer.innerHTML = '';
            
            const examples = plantExamples[mainRec.type] || [];
            examples.forEach(plant => {
                const plantCard = document.createElement('div');
                plantCard.className = 'bg-white rounded-lg shadow-sm overflow-hidden';
                
                plantCard.innerHTML = `
                    <img src="${plant.image}" alt="${plant.name}" class="w-full h-32 object-cover">
                    <div class="p-3">
                        <h4 class="font-medium text-green-700">${plant.name}</h4>
                        <p class="text-sm text-gray-600 mt-1">${plant.description}</p>
                    </div>
                `;
                
                plantExamplesContainer.appendChild(plantCard);
            });
            
            
            const userAnswersSummary = document.getElementById('user-answers-summary');
            userAnswersSummary.innerHTML = '';
            
            questions.forEach(question => {
                if (userAnswersText[question.id]) {
                    const answerDiv = document.createElement('div');
                    answerDiv.className = 'mb-2';
                    answerDiv.innerHTML = `
                        <span class="font-medium">${question.text}</span>
                        <span class="ml-2 text-green-700">${userAnswersText[question.id]}</span>
                    `;
                    userAnswersSummary.appendChild(answerDiv);
                }
            });
            
            // Tampilkan container hasil
            resultContainer.classList.remove('hidden');
            
            // Log hasil untuk debugging
            console.log("Raw Results:", results);
            console.log("Normalized Results:", normalizedResults);
            console.log("Main Recommendation:", mainRec);
        }

        // Fungsi untuk memulai ulang kuis
        function restartQuiz() {
            // Reset jawaban pengguna
            for (const key in userAnswers) {
                delete userAnswers[key];
            }
            
            for (const key in userAnswersText) {
                delete userAnswersText[key];
            }
            
            // Reset indeks pertanyaan
            currentQuestionIndex = 0;
            
            // Sembunyikan hasil
            resultContainer.classList.add('hidden');
            
            // Tampilkan kuis
            document.getElementById('quiz-container').classList.remove('hidden');
            
            // Tampilkan pertanyaan pertama
            showQuestion(currentQuestionIndex);
        }

        // Event listener untuk tombol navigasi
        prevBtn.addEventListener('click', goToPreviousQuestion);
        nextBtn.addEventListener('click', goToNextQuestion);
        restartBtn.addEventListener('click', restartQuiz);

        // Tampilkan pertanyaan pertama saat halaman dimuat
        showQuestion(currentQuestionIndex);
    </script>
</body>
</html>