<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Rekomendasi Tanaman</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
        .question-container {
            transition: all 0.3s ease;
        }
        .fade-out {
            opacity: 0;
            transform: translateY(-20px);
        }
        .fade-in {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body class="bg-gradient-to-b from-green-50 to-green-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-green-800 mb-2">Sistem Rekomendasi Tanaman</h1>
            <p class="text-green-700 max-w-2xl mx-auto">
                Jawab beberapa pertanyaan untuk mendapatkan rekomendasi tanaman yang sesuai dengan kebutuhan dan kondisi Anda
            </p>
        </header>

        <div id="quiz-container" class="max-w-3xl mx-auto">
            <!-- Pertanyaan akan ditampilkan di sini -->
            <div id="question-container" class="bg-white rounded-lg shadow-md p-6 mb-8 question-container">
                <div id="progress-bar" class="w-full bg-gray-200 rounded-full h-2.5 mb-6">
                    <div id="progress" class="bg-green-600 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
                <h2 id="question-title" class="text-xl font-semibold text-green-700 mb-4">Pertanyaan 1</h2>
                <p id="question-text" class="text-gray-700 mb-6">Di mana Anda berencana menanam tanaman?</p>
                
                <div id="options-container" class="space-y-3">
                    <!-- Opsi jawaban akan ditampilkan di sini -->
                </div>
                
                <div class="flex justify-between mt-8">
                    <button id="prev-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed" disabled>Sebelumnya</button>
                    <button id="next-btn" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed" disabled>Selanjutnya</button>
                </div>
            </div>
        </div>

        <!-- Hasil rekomendasi (awalnya tersembunyi) -->
        <div id="result-container" class="max-w-4xl mx-auto hidden">
            <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                <h2 class="text-2xl font-bold text-green-800 mb-4">Hasil Rekomendasi Tanaman</h2>
                
                <div id="recommendation-summary" class="mb-6 p-4 bg-green-50 rounded-lg">
                    <p class="text-lg font-medium text-green-800">Berdasarkan jawaban Anda, kami merekomendasikan:</p>
                    <h3 id="main-recommendation" class="text-2xl font-bold text-green-700 mt-2">-</h3>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-6">
                    <div class="bg-gray-50 rounded-lg p-4 text-center">
                        <h3 class="font-medium text-gray-800">Sayur</h3>
                        <div class="mt-2 h-4 bg-gray-200 rounded-full overflow-hidden">
                            <div id="vegetableBar" class="h-full bg-green-500" style="width: 0%"></div>
                        </div>
                        <p id="vegetableValue" class="mt-1 text-sm font-medium text-green-600">0%</p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4 text-center">
                        <h3 class="font-medium text-gray-800">Buah</h3>
                        <div class="mt-2 h-4 bg-gray-200 rounded-full overflow-hidden">
                            <div id="fruitBar" class="h-full bg-green-500" style="width: 0%"></div>
                        </div>
                        <p id="fruitValue" class="mt-1 text-sm font-medium text-green-600">0%</p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4 text-center">
                        <h3 class="font-medium text-gray-800">Tanaman Hias</h3>
                        <div class="mt-2 h-4 bg-gray-200 rounded-full overflow-hidden">
                            <div id="ornamentalBar" class="h-full bg-green-500" style="width: 0%"></div>
                        </div>
                        <p id="ornamentalValue" class="mt-1 text-sm font-medium text-green-600">0%</p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4 text-center">
                        <h3 class="font-medium text-gray-800">Tanaman Obat</h3>
                        <div class="mt-2 h-4 bg-gray-200 rounded-full overflow-hidden">
                            <div id="medicinalBar" class="h-full bg-green-500" style="width: 0%"></div>
                        </div>
                        <p id="medicinalValue" class="mt-1 text-sm font-medium text-green-600">0%</p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4 text-center">
                        <h3 class="font-medium text-gray-800">Tanaman Rempah</h3>
                        <div class="mt-2 h-4 bg-gray-200 rounded-full overflow-hidden">
                            <div id="spiceBar" class="h-full bg-green-500" style="width: 0%"></div>
                        </div>
                        <p id="spiceValue" class="mt-1 text-sm font-medium text-green-600">0%</p>
                    </div>
                </div>
                
                <div id="plant-details" class="mb-6">
                    <h3 class="text-xl font-semibold text-green-700 mb-3">Contoh Tanaman yang Direkomendasikan</h3>
                    <div id="plant-examples" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- Contoh tanaman akan ditampilkan di sini -->
                    </div>
                </div>
                
                <div id="recommendation-explanation" class="p-4 bg-gray-50 rounded-lg">
                    <h3 class="font-semibold text-green-700 mb-2">Penjelasan Rekomendasi</h3>
                    <p id="explanation-text" class="text-gray-700">-</p>
                </div>
                
                <button id="restart-btn" class="mt-6 w-full px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700">
                    Mulai Lagi
                </button>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6 mt-6">
                <h3 class="text-xl font-semibold text-green-700 mb-3">Jawaban Anda</h3>
                <div id="user-answers-summary" class="text-gray-700">
                    <!-- Ringkasan jawaban pengguna akan ditampilkan di sini -->
                </div>
            </div>
        </div>
    </div>

    <footer class="mt-10 py-6 bg-green-800 text-white text-center">
        <p>Sistem Rekomendasi Tanaman dengan Metode Fuzzy Mamdani &copy; 2025</p>
    </footer>

    <script>
        // Daftar pertanyaan
        const questions = [
            {
                id: 'location',
                title: 'Pertanyaan 1',
                text: 'Di mana Anda berencana menanam tanaman?',
                options: [
                    { id: 'indoor', text: 'Dalam ruangan (indoor)', value: { indoor: 1.0, outdoor: 0.0, garden: 0.0, farm: 0.0 } },
                    { id: 'yard', text: 'Halaman rumah', value: { indoor: 0.3, outdoor: 0.8, garden: 0.4, farm: 0.0 } },
                    { id: 'garden', text: 'Kebun', value: { indoor: 0.0, outdoor: 0.6, garden: 1.0, farm: 0.3 } },
                    { id: 'farm', text: 'Lahan pertanian', value: { indoor: 0.0, outdoor: 0.2, garden: 0.5, farm: 1.0 } }
                ]
            },
            {
                id: 'maintenance',
                title: 'Pertanyaan 2',
                text: 'Berapa banyak waktu yang dapat Anda luangkan untuk merawat tanaman?',
                options: [
                    { id: 'low', text: 'Sedikit (1-2 kali seminggu)', value: { lowMaintenance: 1.0, mediumMaintenance: 0.3, highMaintenance: 0.0 } },
                    { id: 'medium', text: 'Sedang (3-4 kali seminggu)', value: { lowMaintenance: 0.3, mediumMaintenance: 1.0, highMaintenance: 0.3 } },
                    { id: 'high', text: 'Banyak (setiap hari)', value: { lowMaintenance: 0.0, mediumMaintenance: 0.3, highMaintenance: 1.0 } }
                ]
            },
            {
                id: 'purpose',
                title: 'Pertanyaan 3',
                text: 'Apa tujuan utama Anda menanam tanaman?',
                options: [
                    { id: 'consumption', text: 'Untuk dikonsumsi (sayur/buah)', value: { forFood: 1.0, forDecoration: 0.0, forMedicine: 0.2, forSpice: 0.3 } },
                    { id: 'decoration', text: 'Untuk dekorasi/keindahan', value: { forFood: 0.0, forDecoration: 1.0, forMedicine: 0.0, forSpice: 0.0 } },
                    { id: 'medicine', text: 'Untuk pengobatan/herbal', value: { forFood: 0.1, forDecoration: 0.0, forMedicine: 1.0, forSpice: 0.4 } },
                    { id: 'spice', text: 'Untuk bumbu/rempah', value: { forFood: 0.3, forDecoration: 0.0, forMedicine: 0.4, forSpice: 1.0 } }
                ]
            },
            {
                id: 'light',
                title: 'Pertanyaan 4',
                text: 'Bagaimana kondisi pencahayaan di lokasi penanaman?',
                options: [
                    { id: 'low', text: 'Rendah (sedikit terkena sinar matahari)', value: { lowLight: 1.0, mediumLight: 0.3, highLight: 0.0 } },
                    { id: 'medium', text: 'Sedang (terkena sinar matahari tidak langsung)', value: { lowLight: 0.3, mediumLight: 1.0, highLight: 0.3 } },
                    { id: 'high', text: 'Tinggi (terkena sinar matahari langsung)', value: { lowLight: 0.0, mediumLight: 0.3, highLight: 1.0 } }
                ]
            },
            {
                id: 'moisture',
                title: 'Pertanyaan 5',
                text: 'Bagaimana kondisi kelembapan di lokasi penanaman?',
                options: [
                    { id: 'dry', text: 'Kering', value: { dryMoisture: 1.0, mediumMoisture: 0.3, wetMoisture: 0.0 } },
                    { id: 'medium', text: 'Sedang', value: { dryMoisture: 0.3, mediumMoisture: 1.0, wetMoisture: 0.3 } },
                    { id: 'wet', text: 'Basah/Lembap', value: { dryMoisture: 0.0, mediumMoisture: 0.3, wetMoisture: 1.0 } }
                ]
            },
            {
                id: 'temperature',
                title: 'Pertanyaan 6',
                text: 'Berapa suhu rata-rata di lokasi penanaman?',
                options: [
                    { id: 'cool', text: 'Dingin (< 20°C)', value: { coolTemp: 1.0, mediumTemp: 0.3, hotTemp: 0.0 } },
                    { id: 'medium', text: 'Sedang (20-30°C)', value: { coolTemp: 0.3, mediumTemp: 1.0, hotTemp: 0.3 } },
                    { id: 'hot', text: 'Panas (> 30°C)', value: { coolTemp: 0.0, mediumTemp: 0.3, hotTemp: 1.0 } }
                ]
            },
            {
                id: 'ph',
                title: 'Pertanyaan 7',
                text: 'Bagaimana kondisi pH tanah di lokasi penanaman?',
                options: [
                    { id: 'acidic', text: 'Asam (pH < 6)', value: { acidicPh: 1.0, neutralPh: 0.3, basicPh: 0.0 } },
                    { id: 'neutral', text: 'Netral (pH 6-7)', value: { acidicPh: 0.3, neutralPh: 1.0, basicPh: 0.3 } },
                    { id: 'basic', text: 'Basa (pH > 7)', value: { acidicPh: 0.0, neutralPh: 0.3, basicPh: 1.0 } }
                ]
            },
            {
                id: 'space',
                title: 'Pertanyaan 8',
                text: 'Berapa banyak ruang yang tersedia untuk tanaman?',
                options: [
                    { id: 'small', text: 'Kecil (pot/polybag)', value: { smallSpace: 1.0, mediumSpace: 0.3, largeSpace: 0.0 } },
                    { id: 'medium', text: 'Sedang (beberapa meter persegi)', value: { smallSpace: 0.3, mediumSpace: 1.0, largeSpace: 0.3 } },
                    { id: 'large', text: 'Luas (lebih dari 10 meter persegi)', value: { smallSpace: 0.0, mediumSpace: 0.3, largeSpace: 1.0 } }
                ]
            }
        ];

        // Aturan fuzzy untuk rekomendasi tanaman (DIPERBAIKI)
        const rules = [
            // Aturan untuk Sayuran - Bobot diseimbangkan
            {
                condition: (values) => Math.min(
                    values.garden || 0,
                    values.mediumMaintenance || 0,
                    values.forFood || 0,
                    values.highLight || 0,
                    values.mediumMoisture || 0
                ),
                output: 'vegetable',
                weight: 0.8
            },
            {
                condition: (values) => Math.min(
                    values.indoor || 0,
                    values.lowMaintenance || 0,
                    values.forFood || 0,
                    values.mediumLight || 0,
                    values.mediumMoisture || 0,
                    values.smallSpace || 0
                ),
                output: 'vegetable',
                weight: 0.7
            },
            
            // Aturan untuk Buah - Bobot ditingkatkan
            {
                condition: (values) => Math.min(
                    Math.max(values.garden || 0, values.farm || 0),
                    values.highMaintenance || 0,
                    values.forFood || 0,
                    values.highLight || 0,
                    Math.max(values.mediumMoisture || 0, values.wetMoisture || 0),
                    Math.max(values.mediumSpace || 0, values.largeSpace || 0)
                ),
                output: 'fruit',
                weight: 1.0
            },
            {
                condition: (values) => Math.min(
                    values.yard || 0,
                    values.mediumMaintenance || 0,
                    values.forFood || 0,
                    values.highLight || 0,
                    values.mediumMoisture || 0,
                    values.mediumSpace || 0
                ),
                output: 'fruit',
                weight: 0.9
            },
            {
                condition: (values) => Math.min(
                    values.indoor || 0,
                    values.mediumMaintenance || 0,
                    values.forFood || 0,
                    values.highLight || 0,
                    values.mediumMoisture || 0,
                    values.smallSpace || 0
                ),
                output: 'fruit',
                weight: 0.7
            },
            
            // Aturan untuk Tanaman Hias - Bobot ditingkatkan
            {
                condition: (values) => Math.min(
                    values.indoor || 0,
                    Math.max(values.lowMaintenance || 0, values.mediumMaintenance || 0),
                    values.forDecoration || 0,
                    Math.max(values.lowLight || 0, values.mediumLight || 0),
                    Math.max(values.dryMoisture || 0, values.mediumMoisture || 0),
                    values.smallSpace || 0
                ),
                output: 'ornamental',
                weight: 1.0
            },
            {
                condition: (values) => Math.min(
                    values.yard || 0,
                    values.mediumMaintenance || 0,
                    values.forDecoration || 0,
                    values.mediumLight || 0,
                    values.mediumMoisture || 0,
                    values.mediumSpace || 0
                ),
                output: 'ornamental',
                weight: 0.9
            },
            {
                condition: (values) => Math.min(
                    values.garden || 0,
                    values.highMaintenance || 0,
                    values.forDecoration || 0,
                    values.highLight || 0,
                    values.mediumMoisture || 0,
                    values.largeSpace || 0
                ),
                output: 'ornamental',
                weight: 0.8
            },
            
            // Aturan untuk Tanaman Obat - Bobot ditingkatkan
            {
                condition: (values) => Math.min(
                    Math.max(values.indoor || 0, values.yard || 0),
                    Math.max(values.lowMaintenance || 0, values.mediumMaintenance || 0),
                    values.forMedicine || 0,
                    Math.max(values.mediumLight || 0, values.highLight || 0),
                    Math.max(values.dryMoisture || 0, values.mediumMoisture || 0),
                    values.smallSpace || 0
                ),
                output: 'medicinal',
                weight: 1.0
            },
            {
                condition: (values) => Math.min(
                    values.garden || 0,
                    values.mediumMaintenance || 0,
                    values.forMedicine || 0,
                    values.mediumLight || 0,
                    values.mediumMoisture || 0,
                    values.mediumSpace || 0
                ),
                output: 'medicinal',
                weight: 0.9
            },
            {
                condition: (values) => Math.min(
                    values.indoor || 0,
                    values.lowMaintenance || 0,
                    values.forMedicine || 0,
                    values.mediumLight || 0,
                    values.mediumMoisture || 0,
                    values.smallSpace || 0
                ),
                output: 'medicinal',
                weight: 0.95
            },
            
            // Aturan untuk Tanaman Rempah - Bobot ditingkatkan
            {
                condition: (values) => Math.min(
                    Math.max(values.indoor || 0, values.yard || 0),
                    Math.max(values.lowMaintenance || 0, values.mediumMaintenance || 0),
                    values.forSpice || 0,
                    Math.max(values.mediumLight || 0, values.highLight || 0),
                    Math.max(values.dryMoisture || 0, values.mediumMoisture || 0),
                    values.smallSpace || 0
                ),
                output: 'spice',
                weight: 1.0
            },
            {
                condition: (values) => Math.min(
                    values.garden || 0,
                    values.mediumMaintenance || 0,
                    values.forSpice || 0,
                    values.highLight || 0,
                    values.mediumMoisture || 0,
                    values.mediumSpace || 0
                ),
                output: 'spice',
                weight: 0.9
            },
            {
                condition: (values) => Math.min(
                    values.indoor || 0,
                    values.lowMaintenance || 0,
                    values.forSpice || 0,
                    values.mediumLight || 0,
                    values.dryMoisture || 0,
                    values.smallSpace || 0
                ),
                output: 'spice',
                weight: 0.95
            }
        ];

        // Aturan khusus berdasarkan tujuan (DITAMBAHKAN)
        const purposeRules = [
            {
                condition: (values) => values.forFood || 0,
                outputs: { vegetable: 0.6, fruit: 0.7, ornamental: 0.1, medicinal: 0.2, spice: 0.3 }
            },
            {
                condition: (values) => values.forDecoration || 0,
                outputs: { vegetable: 0.1, fruit: 0.2, ornamental: 0.9, medicinal: 0.1, spice: 0.1 }
            },
            {
                condition: (values) => values.forMedicine || 0,
                outputs: { vegetable: 0.2, fruit: 0.1, ornamental: 0.1, medicinal: 0.9, spice: 0.4 }
            },
            {
                condition: (values) => values.forSpice || 0,
                outputs: { vegetable: 0.2, fruit: 0.1, ornamental: 0.1, medicinal: 0.4, spice: 0.9 }
            }
        ];

        // Contoh tanaman untuk setiap kategori
        const plantExamples = {
            vegetable: [
                { name: 'Bayam', description: 'Mudah ditanam, kaya nutrisi, cocok di pot kecil', image: 'https://images.unsplash.com/photo-1576045057995-568f588f82fb?q=80&w=2080&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D' },
                { name: 'Selada', description: 'Tumbuh cepat, cocok untuk hidroponik', image: 'https://images.unsplash.com/photo-1556781366-336f8353ba7c?q=80&w=2080&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D' },
                { name: 'Kangkung', description: 'Tahan berbagai kondisi, mudah perawatan', image: 'https://images.unsplash.com/photo-1654101936389-894aef6f1c11?q=80&w=1935&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D' },
                { name: 'Sawi', description: 'Tumbuh cepat, cocok untuk pemula', image: 'https://via.placeholder.com/150/4ade80/ffffff?text=Sawi' },
                { name: 'Tomat Cherry', description: 'Bisa ditanam di pot, hasil melimpah', image: 'https://via.placeholder.com/150/4ade80/ffffff?text=Tomat' }
            ],
            fruit: [
                { name: 'Stroberi', description: 'Bisa ditanam di pot, buah manis', image: 'https://via.placeholder.com/150/f87171/ffffff?text=Stroberi' },
                { name: 'Jeruk Nipis', description: 'Pohon kecil, cocok di halaman', image: 'https://via.placeholder.com/150/f87171/ffffff?text=Jeruk+Nipis' },
                { name: 'Pepaya', description: 'Tumbuh cepat, buah sepanjang tahun', image: 'https://via.placeholder.com/150/f87171/ffffff?text=Pepaya' },
                { name: 'Jambu Biji', description: 'Tahan kekeringan, buah melimpah', image: 'https://via.placeholder.com/150/f87171/ffffff?text=Jambu+Biji' },
                { name: 'Nanas', description: 'Bisa ditanam di pot besar', image: 'https://via.placeholder.com/150/f87171/ffffff?text=Nanas' }
            ],
            ornamental: [
                { name: 'Monstera', description: 'Daun unik, cocok indoor, minim cahaya', image: 'https://via.placeholder.com/150/a78bfa/ffffff?text=Monstera' },
                { name: 'Lidah Mertua', description: 'Tahan kondisi kering, pembersih udara', image: 'https://via.placeholder.com/150/a78bfa/ffffff?text=Lidah+Mertua' },
                { name: 'Anggrek', description: 'Bunga indah, cocok di tempat teduh', image: 'https://via.placeholder.com/150/a78bfa/ffffff?text=Anggrek' },
                { name: 'Kaktus', description: 'Minim perawatan, tahan kekeringan', image: 'https://via.placeholder.com/150/a78bfa/ffffff?text=Kaktus' },
                { name: 'Sirih Gading', description: 'Merambat indah, cocok di pot gantung', image: 'https://via.placeholder.com/150/a78bfa/ffffff?text=Sirih+Gading' }
            ],
            medicinal: [
                { name: 'Lidah Buaya', description: 'Bermanfaat untuk kulit, mudah perawatan', image: 'https://via.placeholder.com/150/60a5fa/ffffff?text=Lidah+Buaya' },
                { name: 'Jahe', description: 'Rimpang berkhasiat, tumbuh di pot', image: 'https://via.placeholder.com/150/60a5fa/ffffff?text=Jahe' },
                { name: 'Kunyit', description: 'Anti-inflamasi, mudah ditanam', image: 'https://via.placeholder.com/150/60a5fa/ffffff?text=Kunyit' },
                { name: 'Kencur', description: 'Rimpang aromatik, tumbuh di tempat teduh', image: 'https://via.placeholder.com/150/60a5fa/ffffff?text=Kencur' },
                { name: 'Kumis Kucing', description: 'Herba untuk ginjal, mudah perawatan', image: 'https://via.placeholder.com/150/60a5fa/ffffff?text=Kumis+Kucing' }
            ],
            spice: [
                { name: 'Serai', description: 'Aroma harum, pengusir nyamuk', image: 'https://via.placeholder.com/150/fbbf24/ffffff?text=Serai' },
                { name: 'Daun Salam', description: 'Pohon kecil, daun aromatik', image: 'https://via.placeholder.com/150/fbbf24/ffffff?text=Daun+Salam' },
                { name: 'Kemangi', description: 'Aroma khas, tumbuh cepat', image: 'https://via.placeholder.com/150/fbbf24/ffffff?text=Kemangi' },
                { name: 'Cabai Rawit', description: 'Buah pedas, tumbuh subur di pot', image: 'https://via.placeholder.com/150/fbbf24/ffffff?text=Cabai+Rawit' },
                { name: 'Daun Mint', description: 'Aroma segar, mudah merambat', image: 'https://via.placeholder.com/150/fbbf24/ffffff?text=Daun+Mint' }
            ]
        };

        // Deskripsi rekomendasi
        const recommendationDescriptions = {
            vegetable: "Tanaman sayur sangat cocok dengan kondisi yang Anda miliki. Sayuran umumnya membutuhkan sinar matahari yang cukup, kelembapan sedang, dan perawatan rutin. Sayuran juga memberikan hasil yang dapat dikonsumsi dalam waktu relatif singkat.",
            fruit: "Tanaman buah adalah pilihan yang tepat untuk Anda. Meskipun beberapa tanaman buah membutuhkan waktu lebih lama untuk berbuah, namun hasilnya akan sepadan. Pastikan untuk memberikan ruang yang cukup dan sinar matahari yang memadai.",
            ornamental: "Tanaman hias sangat sesuai dengan kondisi Anda. Tanaman hias umumnya lebih fleksibel dalam hal pencahayaan dan dapat bertahan dengan perawatan minimal. Tanaman ini akan menambah keindahan dan kesegaran di lingkungan Anda.",
            medicinal: "Tanaman obat (TOGA) adalah rekomendasi terbaik untuk Anda. Tanaman obat umumnya tidak memerlukan perawatan intensif dan dapat tumbuh di berbagai kondisi. Selain itu, tanaman ini memberikan manfaat kesehatan yang dapat digunakan sehari-hari.",
            spice: "Tanaman rempah sangat cocok dengan kondisi yang Anda miliki. Tanaman rempah umumnya tahan terhadap berbagai kondisi dan memberikan aroma serta rasa yang dapat dimanfaatkan untuk memasak. Banyak tanaman rempah juga memiliki manfaat kesehatan."
        };

        // Variabel untuk melacak pertanyaan saat ini dan jawaban
        let currentQuestionIndex = 0;
        const userAnswers = {};
        const userAnswersText = {};

        // Elemen DOM
        const questionContainer = document.getElementById('question-container');
        const questionTitle = document.getElementById('question-title');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const progressBar = document.getElementById('progress');
        const resultContainer = document.getElementById('result-container');
        const restartBtn = document.getElementById('restart-btn');

        // Fungsi untuk menampilkan pertanyaan
        function showQuestion(index) {
            const question = questions[index];
            
            // Update judul dan teks pertanyaan
            questionTitle.textContent = question.title;
            questionText.textContent = question.text;
            
            // Bersihkan opsi sebelumnya
            optionsContainer.innerHTML = '';
            
            // Tambahkan opsi baru
            question.options.forEach(option => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'flex items-center space-x-3';
                
                const input = document.createElement('input');
                input.type = 'radio';
                input.name = question.id;
                input.id = option.id;
                input.className = 'w-4 h-4 text-green-600 focus:ring-green-500';
                input.value = option.id;
                
                // Periksa apakah opsi ini sudah dipilih sebelumnya
                if (userAnswers[question.id] === option.id) {
                    input.checked = true;
                }
                
                // Tambahkan event listener
                input.addEventListener('change', () => {
                    userAnswers[question.id] = option.id;
                    userAnswers[question.id + '_value'] = option.value;
                    userAnswersText[question.id] = option.text;
                    nextBtn.disabled = false;
                });
                
                const label = document.createElement('label');
                label.htmlFor = option.id;
                label.className = 'text-gray-700 cursor-pointer';
                label.textContent = option.text;
                
                optionDiv.appendChild(input);
                optionDiv.appendChild(label);
                optionsContainer.appendChild(optionDiv);
            });
            
            // Update tombol navigasi
            prevBtn.disabled = index === 0;
            nextBtn.disabled = !userAnswers[question.id];
            
            // Jika ini pertanyaan terakhir, ubah teks tombol "Selanjutnya"
            if (index === questions.length - 1) {
                nextBtn.textContent = 'Lihat Hasil';
            } else {
                nextBtn.textContent = 'Selanjutnya';
            }
            
            // Update progress bar
            const progress = ((index + 1) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // Fungsi untuk pindah ke pertanyaan sebelumnya
        function goToPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                questionContainer.classList.add('fade-out');
                
                setTimeout(() => {
                    currentQuestionIndex--;
                    showQuestion(currentQuestionIndex);
                    questionContainer.classList.remove('fade-out');
                    questionContainer.classList.add('fade-in');
                    
                    setTimeout(() => {
                        questionContainer.classList.remove('fade-in');
                    }, 300);
                }, 300);
            }
        }

        // Fungsi untuk pindah ke pertanyaan berikutnya
        function goToNextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                questionContainer.classList.add('fade-out');
                
                setTimeout(() => {
                    currentQuestionIndex++;
                    showQuestion(currentQuestionIndex);
                    questionContainer.classList.remove('fade-out');
                    questionContainer.classList.add('fade-in');
                    
                    setTimeout(() => {
                        questionContainer.classList.remove('fade-in');
                    }, 300);
                }, 300);
            } else {
                // Ini adalah pertanyaan terakhir, tampilkan hasil
                showResults();
            }
        }

        // Fungsi untuk mengevaluasi aturan fuzzy (DIPERBAIKI)
        function evaluateRules() {
            // Gabungkan semua nilai dari jawaban pengguna
            const values = {};
            for (const key in userAnswers) {
                if (key.endsWith('_value')) {
                    const valueObj = userAnswers[key];
                    for (const valueKey in valueObj) {
                        values[valueKey] = valueObj[valueKey];
                    }
                }
            }
            
            // Evaluasi setiap aturan
            const results = {
                vegetable: 0,
                fruit: 0,
                ornamental: 0,
                medicinal: 0,
                spice: 0
            };
            
            // Evaluasi aturan umum
            rules.forEach(rule => {
                const ruleStrength = rule.condition(values) * rule.weight;
                results[rule.output] = Math.max(results[rule.output], ruleStrength);
            });
            
            // Evaluasi aturan khusus berdasarkan tujuan (DITAMBAHKAN)
            purposeRules.forEach(rule => {
                const ruleStrength = rule.condition(values);
                if (ruleStrength > 0) {
                    for (const output in rule.outputs) {
                        const outputStrength = ruleStrength * rule.outputs[output];
                        results[output] = Math.max(results[output], outputStrength);
                    }
                }
            });
            
            // Berikan bobot tambahan berdasarkan lokasi (DITAMBAHKAN)
            if (values.indoor > 0.5) {
                results.ornamental *= 1.2;
                results.medicinal *= 1.1;
                results.spice *= 1.1;
            }
            
            if (values.garden > 0.5) {
                results.vegetable *= 1.1;
                results.fruit *= 1.1;
            }
            
            if (values.farm > 0.5) {
                results.vegetable *= 1.2;
                results.fruit *= 1.2;
            }
            
            // Berikan bobot tambahan berdasarkan tujuan (DITAMBAHKAN)
            if (userAnswers.purpose === 'consumption') {
                results.vegetable *= 1.2;
                results.fruit *= 1.2;
            } else if (userAnswers.purpose === 'decoration') {
                results.ornamental *= 1.5;
            } else if (userAnswers.purpose === 'medicine') {
                results.medicinal *= 1.5;
            } else if (userAnswers.purpose === 'spice') {
                results.spice *= 1.5;
            }
            
            return results;
        }

        // Fungsi untuk menormalisasi hasil
        function normalizeResults(results) {
            const total = Object.values(results).reduce((sum, val) => sum + val, 0);
            
            if (total === 0) return results; // Hindari pembagian dengan nol
            
            const normalized = {};
            for (const key in results) {
                normalized[key] = (results[key] / total) * 100;
            }
            
            return normalized;
        }

        // Fungsi untuk mendapatkan rekomendasi utama
        function getMainRecommendation(results) {
            let maxKey = Object.keys(results)[0];
            let maxValue = results[maxKey];
            
            for (const key in results) {
                if (results[key] > maxValue) {
                    maxValue = results[key];
                    maxKey = key;
                }
            }
            
            return {
                type: maxKey,
                value: maxValue
            };
        }

        // Fungsi untuk menampilkan hasil
        function showResults() {
            // Sembunyikan container pertanyaan
            document.getElementById('quiz-container').classList.add('hidden');
            
            // Evaluasi aturan fuzzy
            const results = evaluateRules();
            const normalizedResults = normalizeResults(results);
            const mainRec = getMainRecommendation(normalizedResults);
            
            // Tampilkan hasil
            document.getElementById('vegetableBar').style.width = `${normalizedResults.vegetable}%`;
            document.getElementById('vegetableValue').textContent = `${normalizedResults.vegetable.toFixed(1)}%`;
            
            document.getElementById('fruitBar').style.width = `${normalizedResults.fruit}%`;
            document.getElementById('fruitValue').textContent = `${normalizedResults.fruit.toFixed(1)}%`;
            
            document.getElementById('ornamentalBar').style.width = `${normalizedResults.ornamental}%`;
            document.getElementById('ornamentalValue').textContent = `${normalizedResults.ornamental.toFixed(1)}%`;
            
            document.getElementById('medicinalBar').style.width = `${normalizedResults.medicinal}%`;
            document.getElementById('medicinalValue').textContent = `${normalizedResults.medicinal.toFixed(1)}%`;
            
            document.getElementById('spiceBar').style.width = `${normalizedResults.spice}%`;
            document.getElementById('spiceValue').textContent = `${normalizedResults.spice.toFixed(1)}%`;
            
            // Tampilkan rekomendasi utama
            let mainType;
            switch(mainRec.type) {
                case 'vegetable': mainType = 'Sayur'; break;
                case 'fruit': mainType = 'Buah'; break;
                case 'ornamental': mainType = 'Tanaman Hias'; break;
                case 'medicinal': mainType = 'Tanaman Obat (TOGA)'; break;
                case 'spice': mainType = 'Tanaman Rempah'; break;
                default: mainType = '-';
            }
            
            document.getElementById('main-recommendation').textContent = mainType;
            document.getElementById('explanation-text').textContent = recommendationDescriptions[mainRec.type] || '';
            
            // Tampilkan contoh tanaman
            const plantExamplesContainer = document.getElementById('plant-examples');
            plantExamplesContainer.innerHTML = '';
            
            const examples = plantExamples[mainRec.type] || [];
            examples.slice(0, 3).forEach(plant => {
                const plantCard = document.createElement('div');
                plantCard.className = 'bg-white rounded-lg shadow-sm overflow-hidden';
                
                plantCard.innerHTML = `
                    <img src="${plant.image}" alt="${plant.name}" class="w-full h-32 object-cover">
                    <div class="p-3">
                        <h4 class="font-medium text-green-700">${plant.name}</h4>
                        <p class="text-sm text-gray-600 mt-1">${plant.description}</p>
                    </div>
                `;
                
                plantExamplesContainer.appendChild(plantCard);
            });
            
            // Tampilkan ringkasan jawaban pengguna
            const userAnswersSummary = document.getElementById('user-answers-summary');
            userAnswersSummary.innerHTML = '';
            
            questions.forEach(question => {
                if (userAnswersText[question.id]) {
                    const answerDiv = document.createElement('div');
                    answerDiv.className = 'mb-2';
                    answerDiv.innerHTML = `
                        <span class="font-medium">${question.text}</span>
                        <span class="ml-2 text-green-700">${userAnswersText[question.id]}</span>
                    `;
                    userAnswersSummary.appendChild(answerDiv);
                }
            });
            
            // Tampilkan container hasil
            resultContainer.classList.remove('hidden');
        }

        // Fungsi untuk memulai ulang kuis
        function restartQuiz() {
            // Reset jawaban pengguna
            for (const key in userAnswers) {
                delete userAnswers[key];
            }
            
            for (const key in userAnswersText) {
                delete userAnswersText[key];
            }
            
            // Reset indeks pertanyaan
            currentQuestionIndex = 0;
            
            // Sembunyikan hasil
            resultContainer.classList.add('hidden');
            
            // Tampilkan kuis
            document.getElementById('quiz-container').classList.remove('hidden');
            
            // Tampilkan pertanyaan pertama
            showQuestion(currentQuestionIndex);
        }

        // Event listener untuk tombol navigasi
        prevBtn.addEventListener('click', goToPreviousQuestion);
        nextBtn.addEventListener('click', goToNextQuestion);
        restartBtn.addEventListener('click', restartQuiz);

        // Tampilkan pertanyaan pertama saat halaman dimuat
        showQuestion(currentQuestionIndex);
    </script>
</body>
</html>